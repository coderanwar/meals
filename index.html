---
layout: default
title: "Home"
theme-color: "green"
color: "lightgreen"
---
{% assign meal_counter = 1 %}
{% for meal in site.data.meals %}
    <h2 style="color: green;">Date: {{ meal.Date | date: "%b %-d, %Y" }}</h2>
    <p style="color: green;">
        <span style="color: green;">Advance: {{ meal.Advance }} | </span> 
        <span style="color: red;">Due: {{ meal.Due }} | </span>
        {% if meal_counter == 1 %}
            <span id="payment" style="color: indigo;">Payment: |</span>
            <a href="update.html">Update</a>
        {% else %}
        <span style="color: green;">Paid: {{ meal.Paid }} |</span>
        {% endif %}
    </p>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Balance</th>
                <th>Noon</th>
                <th>Night</th>
                <th>Total</th>
            </tr>
        </thead>
        </tbody>
        {% for people in meal.Peoples %}
            <tr>
                <td>{{ people.Name }}</td>
                <td {% if people.Balance < 35 and meal_counter == 1 %}
                        style="color:red;" 
                    {% elsif people.Balance < 70 and meal_counter == 1 %}
                        {% if people.TotalMeal == 2 %}
                            style="color:red"
                        {% else %}
                            style="color:orange"
                        {% endif %}
                    {% endif %}>
                        {{ people.Balance }}
                </td>
                <td>{{ people.Noon }}</td>
                <td>{{ people.Night }}</td>
                <td>{{ people.TotalMeal }}</td>
            </tr>
        {% endfor %}
        {% if meal_counter == 1 %}
            <tr style="background: green;color:lightgreen;font-weight: bold;">
                <td>Total</td>
                <td id="totalBalance"></td>
                <td id="totalNoon"></td>
                <td id="totalNight"></td>
                <td id="totalMeal"></td>
            </tr>
            {% assign meal_counter = 2 %}
        {% endif %}
        </tbody>
        <tbody>
    </table>
    {% if meal_counter == 2 %}
       <p>Updated at: {{ site.time }} | <a htef="https://github.com/coderanwar/meals/blob/master/_data/meals.yml">Data</a></p>
    {% endif %}
    {% if meal_counter == 2 %}
        <script>
            var total = [
                {% for people in meal.Peoples %}
                    [{{people.Balance }}, {{ people.Noon }}, {{ people.Night }}, {{ people.TotalMeal }}],
                {% endfor %}
            ];
            var totalBalance = 0;
            var totalNoon = 0;
            var totalNight = 0;
            var totalMeal = 0;
            var totalPayment;
            var i;
            for (i = 0; i < total.length; i++) {
                totalBalance += total[i][0];
                totalNoon += total[i][1];
                totalNight += total[i][2];
                totalMeal += total[i][3];
            }
            document.getElementById("totalBalance").innerHTML = totalBalance;
            document.getElementById("totalNoon").innerHTML = totalNoon;
            document.getElementById("totalNight").innerHTML = totalNight;
            document.getElementById("totalMeal").innerHTML = totalMeal;

            totalPayment = (totalMeal * 35) - {{ meal.Advance }} + {{ meal.Due }};

            document.getElementById("payment").innerHTML = "Payment: " + totalPayment + " | ";
        </script>
        {% assign meal_counter = 3 %}
    {% endif %}
    <br><hr>
{% endfor %}
