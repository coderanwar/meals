---
layout: default
title: "Update"
theme-color: "red"
color: "white"
---
<div>
<h3 style="text-align:center;color:{{page.theme-color}}">
  Update: 
  <a href="https://github.com/coderanwar/meals/edit/master/_data/meals.yml" style="font-size: 18px;">Edit</a>
</h3>
<textarea name="" id="mealData" style="width:100%;height:1000px;color:red;border:2px solid red;border-radius:6px;">

- Date: {{ site.time | date: "%Y-%m-%d" }}
</textarea>
</div>

<script>
  var total = [
      {% for people in site.data.meals[0].Peoples %}
          ["{{people.Name }}", {{people.Balance }}, {{ people.Noon }}, {{ people.Night }}, {{ people.TotalMeal }}],
      {% endfor %}
  ];
  var totalBalance = 0;
  var balance;
  var totalMeal = 0;
  var totalPayment;
  var paid;
  var i;
  var text = "";

  for (i = 0; i < total.length; i++) {
    balance = total[i][1] - (total[i][4] * 35);
    totalMeal += total[i][4];
  }
  totalPayment = (totalMeal * 35) - {{ site.data.meals[0].Advance }} + {{ site.data.meals[0].Due }};
  paid = {{ site.data.meals[0].Paid }} ;

  if (paid > totalPayment) {
    document.getElementById("mealData").innerHTML += '  Paid: 0\n' +
    '  Advance: ' + (paid - totalPayment) + '\n' +
    '  Due: {{ site.data.meals[0].Due }} \n' +
    '  Peoples:\n';
  } else if (paid < totalPayment && paid > 0) {
    document.getElementById("mealData").innerHTML += '  Paid: 0\n' +
    '  Advance: {{ site.data.meals[0].Advance }} \n' +
    '  Due: ' + (totalPayment - paid) + '\n' +
    '  Peoples:\n';
  } else {
    document.getElementById("mealData").innerHTML += '  Paid: 0\n' +
    '  Advance: {{ site.data.meals[0].Advance }} \n' +
    '  Due: {{ site.data.meals[0].Due }} \n' +
    '  Peoples:\n';
  }

  for (i = 0; i < total.length; i++) {
    document.getElementById("mealData").innerHTML += '    - Name: "' + total[i][0] + '"\n';
    balance = total[i][1] - (total[i][4] * 35);
    if (balance > 0) {
      document.getElementById("mealData").innerHTML += '      Balance: ' + balance + '\n';
    } else {
      document.getElementById("mealData").innerHTML += '      Balance: ' + total[i][1] + '\n';
    }
    document.getElementById("mealData").innerHTML += '      Noon: ' + total[i][2] + '\n';
    document.getElementById("mealData").innerHTML += '      Night: ' + total[i][3] + '\n';
    document.getElementById("mealData").innerHTML += '      TotalMeal: ' + total[i][4] + '\n';
  }

</script>
